Встроенные сервера нужны для того, чтобы без мороки создавать красивое место, где игрок может находиться, пока вводит пароль.

Обычно для этого нужно создавать отдельный сервер - самостоятельно запускать его, ставить туда плагины для ограничений... Это слишком сложно ради такой простой цели.

Именно поэтому BaronessAuth умеет делать это за вас!

::: warning
После изменения любых настроек встроенных серверов нужно полностью перезагружать прокси!
:::

## Типы серверов

Сейчас в BaronessAuth есть 2 типа серверов, каждый под разные цели:

1. **Полный** (`full`) - поддерживает все версии от 1.8 до последней, умеет ставить схематику. Игрок свободно может бегать по схематике, но не может ничего сломать. Игроки не видят друг друга. Такой сервер слабо нагружает процессор, но требует до 1 гигабайта ОЗУ.

2. **Минимальный** (`minimal`) - поддерживает все версии от 1.8 до последней, но не умеет ставить схематику. Игрок висит в пустоте на месте. Этот сервер совсем легковесный и обычно потребляет до 150 мегабайт ОЗУ.

Созданные сервера доступны во всей сети серверов, то есть это обычные, полноценные сервера, просто автоматически управляемые BaronessAuth.

### Полный

Чтобы создать такой сервер, перейдите к `embedded-servers` в `general.yml` и добавьте новую секцию:

```yml
  embedded-servers:
    'название-сервера': !<full>
      # Включён ли сервер? Позволяет отключить его, не удаляя из конфига.
      enabled: true
      # Если указан порт 0, плагин автоматически выберет свободный - менять необязательно.
      port: 0
      # Сколько максимально памяти может потреблять сервер?
      # Если указать слишком мало, сервер крашнется - BaronessAuth восстановит его, но этого лучше избегать.
      max-ram: '1 GiB'
      # Снизу написано, как установить схематику - читайте дальше!
      schematic: 'default-auth.schem'
      # Статичное время на сервере, значения: https://minecraft.fandom.com/wiki/Daylight_cycle#24-hour_Minecraft_day
      # Установите -1, чтобы оно не было статичным (будет ванильный цикл дня и ночи).
      time: 12040
      # Включить/выключить погоду.
      # Если погода выключена, всегда будет ясное небо.
      weather: true
      # Настройки Java (вам не стоит тут ничего менять)
      java:
        provider: !<automatic> {}
        extra-flags: []
```

#### Установка схематики

В плагине есть встроенные схематики - `default-auth.schem` и `default-lobby.schem` - их достаточно просто указать, плагин всё поймёт.

А если вы хотите добавить свою, это делается нехитрым способом:

1. Зайдите на какой-нибудь сервер с правами админа и установленным WorldEdit.
2. Выделите область через WorldEdit.
3. Введите `//copy`, стоя на месте спавна игрока.
4. Вы смотрите на север? А должны - игроки всегда спавнятся лицом на север. Используйте `//rotate` и `//paste`, чтобы развернуть выделение и подтвердить успех.
5. Создайте файл схематики через `//schem save`.
6. Созданный файл переложите в `BaronessAuth/`, чтобы было, например, `BaronessAuth/my-schematic.schem`.
7. Введите в секцию `schematic` название своего файла, например, `my-schematic.schem`.

Вот и всё - после рестарта прокси вы должны увидеть свою схематику!

### Минимальный

Чтобы создать такой сервер, перейдите к `embedded-servers` в `general.yml` и добавьте новую секцию:

```yml
  embedded-servers:
    'название-сервера': !<minimal>
      # Включён ли сервер? Позволяет отключить его, не удаляя из конфига.
      enabled: true
      # Если указан порт 0, плагин автоматически выберет свободный - менять необязательно.
      port: 0
      # Сколько максимально памяти может потреблять сервер?
      # Если указать слишком мало, сервер крашнется - BaronessAuth восстановит его, но этого лучше избегать.
      max-ram: '128 MiB'
      # Вид мира (overworld, nether, the_end).
      dimension: 'overworld'
      # Режим игрока (survival, creative, adventure, spectator).
      game-mode: 'creative'
      # Настройки Java (вам не стоит тут ничего менять)
      java:
        provider: !<automatic> {}
        override-flags: []
```

Больше тут настроить нечего - на то он и минимальный.

## Настройки Java

Встроенные сервера типа `full` и `minimal` работают, запуская сторонний Java процесс, поэтому плагину нужна Java.

У BaronessAuth есть несколько способ получить её:

1. `automatic` - плагин самостоятельно подготавливает Java, скачивая наиболее оптимальный дистрибутив, наиболее оптимальной версии. Он скачивает JDK и создаёт на её основе минимальный образ, используя `jlink`. Таким образом вы получаете 100% обновлённую и подходящую под ваши цели и систему Java, но на это уходит около 80 МБ диска. Это абсолютно стабильный вариант - версия JDK меняется только с обновлением самого плагине, нет риска, что плагин вдруг скачает какую-то нестабильную версию. Пока версия актуальна, плагин ничего не качает - достаточно 1 раз немного подождать:

```yml
      java:
        provider: !<automatic> {}
        override-flags: []
```

2. `current` - плагин использует Java, с которой запущен сам процесс прокси. Довольно быстро, но не очень "стабильно" (плагин не может ничего гарантировать) - у вас может быть JRE 17, тогда как встроенному серверу нужна 21 - в таком случае сервер будет бесконечно перезагружаться. Этот способ также включается, если ваша ОС и архитектура не поддерживается методом `automatic`:

```yml
      java:
        provider: !<current> {}
        override-flags: []
```

3. `custom` - плагин запускает чётко тот исполняемый файл, который вы введёте. Тут уже вы решаете, запустится сервер сегодня или нет - всё в ваших руках:

```yml
      java:
        provider: !<custom>
          path: '/home/admin/jdk-21/bin/java'
        override-flags: []
```

### Флаги

Вам не нужно настраивать флаги самостоятельно - BaronessAuth уже "из коробки" старается подобрать самые лучшие и экономные варианты, совместимые с целевой версией Java.

Но вы можете определить свои флаги. **Если вы укажите хотя бы один флаг, BaronessAuth подставит только ваши флаги.** Не забудьте о базовых вещах, типа лимитов ОЗУ и EULA.

```yml
      java:
        provider: !<automatic> {}
        override-flags:
          - '-Xms128M'
          - '-XX:+UseG1GC'
          - '-XX:+UseStringDeduplication'
          - '-Dcom.mojang.eula.agree=true'
          - '-DPaper.IgnoreJavaVersion=true'
```